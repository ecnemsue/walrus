"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[4768],{6469:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"usage/quilt","title":"Quilt: Walrus Native Batch Store Tool","description":"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.","source":"@site/../content/usage/quilt.mdx","sourceDirName":"usage","slug":"/usage/quilt","permalink":"/docs/usage/quilt","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/usage/quilt.mdx","tags":[],"version":"current","frontMatter":{"title":"Quilt: Walrus Native Batch Store Tool","description":"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.","keywords":["walrus","quilt","batch storage","cost optimization","small blobs","metadata","efficiency","storage tool","quilt patch id"]},"sidebar":"docsSidebar","previous":{"title":"Data Security","permalink":"/docs/dev-guide/data-security"},"next":{"title":"Operator Guide","permalink":"/docs/operator-guide/"}}');var n=i(2714),l=i(8885);const a={title:"Quilt: Walrus Native Batch Store Tool",description:"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.",keywords:["walrus","quilt","batch storage","cost optimization","small blobs","metadata","efficiency","storage tool","quilt patch id"]},o=void 0,r={},d=[{value:"Important considerations",id:"important-considerations",level:2},{value:"Target use cases",id:"target-use-cases",level:2},{value:"Lower cost",id:"lower-cost",level:3},{value:"Organizing collections",id:"organizing-collections",level:3},{value:"Walrus native blob metadata",id:"walrus-native-blob-metadata",level:3}];function c(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Term:i}=t;return i||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Term",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:"Quilt"})," is a batch storage feature, aiming to optimize the storage cost and efficiency of large\nnumbers of small ",(0,n.jsx)(i,{lookup:"Blob",children:"blobs"}),". Prior to ",(0,n.jsx)(t.em,{children:"quilt"}),", storing small ","blobs"," (less than 10MB) in Walrus\ninvolved higher per-byte costs due to internal system data overhead. ",(0,n.jsx)(t.em,{children:"Quilt"})," addresses this by\nencoding multiple (up to 666 for QuiltV1) ","blobs"," into a single unit called a quilt, significantly\nreducing Walrus storage overhead and lowering costs to purchase Walrus/Sui storage, as well as Sui\ncomputation gas fees."]}),"\n",(0,n.jsxs)(t.p,{children:["Importantly, each ","blob"," within a quilt can be accessed and retrieved individually, without needing\nto download the entire quilt. Moreover, the ","blob"," boundaries in a quilt align with Walrus\ninternal structures as well as Walrus ",(0,n.jsx)(i,{lookup:"Storage node",children:"storage nodes"}),", this allows for retrieval latency that is\ncomparable to, or even lower than, that of a regular ","blob","."]}),"\n",(0,n.jsxs)(t.p,{children:["In addition, ",(0,n.jsx)(t.em,{children:"quilt"})," introduces custom, immutable ",(0,n.jsx)(t.code,{children:"Walrus-native"}),(0,n.jsx)(i,{lookup:"Blob metadata",children:"blob metadata"}),", allowing ",(0,n.jsx)(i,{lookup:"User",children:"user"})," to\nassign different types of ",(0,n.jsx)(t.code,{children:"metadata"})," to each ","blob"," in a quilt, for example, unique identifiers, as\nwell as tags of key-value pairs. Note, this metadata is functionally similar to the existing\n","Blob Metadata"," store on-chain, however, there are some fundamental distinctions. First,\n",(0,n.jsx)(t.code,{children:"Walrus-native"})," metadata is stored alongside the ","blob"," data, and hence it reduces costs and\nsimplifies management. Second, this metadata can be used for efficient lookup of ","blobs"," within a\nquilt, for example, reading ","blobs"," with a particular tag. When storing a quilt, users can set\nthe ",(0,n.jsx)(t.code,{children:"Walrus-native"})," metadata via the ",(0,n.jsx)(t.em,{children:"quilt"})," APIs."]}),"\n",(0,n.jsxs)(t.admonition,{type:"warning",children:[(0,n.jsx)(t.p,{children:"An identifier must start with an alphanumeric character, contain no trailing whitespace,\nand not exceed 64 KB in length."}),(0,n.jsx)(t.p,{children:"The total size of all tags combined must not exceed 64 KB."})]}),"\n",(0,n.jsx)(t.h2,{id:"important-considerations",children:"Important considerations"}),"\n",(0,n.jsxs)(t.p,{children:["It's important to note that ","blobs"," stored in a quilt are assigned a unique ID, called ",(0,n.jsx)(t.code,{children:"QuiltPatchId"}),",\nthat differs from the ",(0,n.jsx)(t.code,{children:"BlobId"})," used for regular Walrus ","blobs",", and a ",(0,n.jsx)(t.code,{children:"QuiltPatchId"})," is determined by\nthe composition of the entire quilt, ranther than the single ","blob",", and hence it may change if the\n","blob"," is stored in a different quilt. Moreover, individual ","blobs"," cannot be deleted, extended or shared\nseparately; these operations can only be applied to the entire quilt."]}),"\n",(0,n.jsx)(t.h2,{id:"target-use-cases",children:"Target use cases"}),"\n",(0,n.jsxs)(t.p,{children:["Using ",(0,n.jsx)(t.em,{children:"quilt"})," requires minimal additional effort beyond standard procedures. The primary\nconsiderations are that the unique ID assigned to each ","blob"," within a quilt cannot be\ndirectly derived from its contents, unlike a regular Walrus blob_id, deletion, extension\nand share operations are not allowed on individual ","blobs"," in the quilt, only the quilt\ncan be the target."]}),"\n",(0,n.jsx)(t.h3,{id:"lower-cost",children:"Lower cost"}),"\n",(0,n.jsxs)(t.p,{children:["This is the most clear and significant use case. ",(0,n.jsx)(t.em,{children:"Quilt"})," is especially advantageous for\nmanaging large volumes of small ","blobs",", as long as they can be grouped together by the\n","user",". The cost savings come from two sources:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Walrus storage and write fees"}),": By consolidating multiple small ","blobs"," into a single\nquilt, storage costs can be reduced dramatically\u2014more than 400x for files around 10KB\u2014making\nit an efficient solution for cost-sensitive applications."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Sui computation and object storage fees"}),": Storing many ","blobs"," as a single quilt\nsignificantly reduces Sui gas costs. In our test runs with 600 files stored in a quilt,\nwe observed ",(0,n.jsx)(t.strong,{children:"238x"})," savings in Sui fees compared to storing them as individual ","blobs",".\nNotably, Sui cost savings only depend on the number of files per quilt rather than the\nindividual file sizes."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The following table demonstrates the potential cost savings in ",(0,n.jsx)(i,{lookup:"WAL",children:"WAL"})," when storing 600 small\n","blobs"," for 1 epoch as a quilt compared to storing them as separate ","blobs","."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.th,{style:{textAlign:"right"},children:["Blob"," size"]}),(0,n.jsxs)(t.th,{style:{textAlign:"right"},children:["Regular ","blob"," storage cost"]}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Quilt storage cost"}),(0,n.jsx)(t.th,{style:{textAlign:"right"},children:"Cost saving factor"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"10KB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.005 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"409x"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"50KB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.011 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"190x"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"100KB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.020 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"104x"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"200KB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.036 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"58x"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"500KB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.136 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.084 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"25x"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"1MB"}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["2.208 ","WAL"]}),(0,n.jsxs)(t.td,{style:{textAlign:"right"},children:["0.170 ","WAL"]}),(0,n.jsx)(t.td,{style:{textAlign:"right"},children:"13x"})]})]})]}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Note:"})," The costs shown in this table are for illustrative purposes only and were obtained\nfrom test runs on Walrus Testnet. Actual costs may vary due to changes in smart contract\nparameters, networks, and other factors. The comparison is between storing 600 files as a single\nquilt versus storing them as individual ","blobs"," in batches of 25."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"organizing-collections",children:"Organizing collections"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:"Quilt"})," provides a straightforward way to organize and manage collections of small ","blobs","\nwithin a single unit. This can simplify data handling and improve operational efficiency\nwhen working with related small files, such as NFT image collections."]}),"\n",(0,n.jsxs)(t.h3,{id:"walrus-native-blob-metadata",children:["Walrus native ","blob metadata"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:"Quilt"})," supports immutable, custom metadata stored directly in Walrus, including\nidentifiers and tags. These features facilitate better organization, enable flexible\nlookup, and assist in managing ","blobs"," within each quilt, enhancing retrieval and\nmanagement processes."]}),"\n",(0,n.jsxs)(t.p,{children:["For details on how to use the CLI to interact with ",(0,n.jsx)(t.em,{children:"quilt"}),", see the\n",(0,n.jsx)(t.a,{href:"/docs/usage/client-cli#batch-store",children:"Batch-storing blobs with quilts"})," section."]})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8885:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>o});var s=i(9378);const n={},l=s.createContext(n);function a(e){const t=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);
"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[9403],{246:(e,s,o)=>{o.r(s),o.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"dev-guide/costs","title":"Storage Costs","description":"Comprehensive guide to Walrus storage costs including WAL tokens, SUI gas fees, and cost optimization strategies.","source":"@site/../content/dev-guide/costs.mdx","sourceDirName":"dev-guide","slug":"/dev-guide/costs","permalink":"/docs/dev-guide/costs","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/dev-guide/costs.mdx","tags":[],"version":"current","frontMatter":{"title":"Storage Costs","description":"Comprehensive guide to Walrus storage costs including WAL tokens, SUI gas fees, and cost optimization strategies.","keywords":["walrus","storage costs","wal token","sui gas","cost optimization","storage resources","upload costs","tokenomics"]},"sidebar":"docsSidebar","previous":{"title":"Operations","permalink":"/docs/dev-guide/dev-operations"},"next":{"title":"Sui Structures","permalink":"/docs/dev-guide/sui-struct"}}');var n=o(2714),r=o(8885);const i={title:"Storage Costs",description:"Comprehensive guide to Walrus storage costs including WAL tokens, SUI gas fees, and cost optimization strategies.",keywords:["walrus","storage costs","wal token","sui gas","cost optimization","storage resources","upload costs","tokenomics"]},a=void 0,c={},l=[{value:"Understanding the 4 Sources of Cost",id:"understanding-the-4-sources-of-cost",level:2},{value:"Measuring Costs",id:"measuring-costs",level:2},{value:"Managing and Minimizing Costs",id:"managing-and-minimizing-costs",level:2},{value:"Reducing Costs for Small Blobs",id:"reducing-costs-for-small-blobs",level:3},{value:"The Future",id:"the-future",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Term:t}=s;return t||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Term",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["Storing ",(0,n.jsx)(t,{lookup:"Blob",children:"blobs"})," on Walrus Mainnet consumes ",(0,n.jsx)(t,{lookup:"WAL",children:"WAL"})," for the storage operation, and SUI for executing\ntransactions on Sui. This section provides a summary of the costs involved, and also some\nadvice on how to manage or minimize them for specific scenarios."]}),"\n",(0,n.jsxs)(s.p,{children:["This document deals with costs of storage specifically. You can find a wider discussion about\nthe ",(0,n.jsx)(s.a,{href:"https://www.walrus.xyz/wal-token",children:"WAL tokenonmics"}),", and the role it plays in the\n",(0,n.jsx)(s.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:o(5076).A+"",children:"Walrus delegated proof of stake system"})," elsewhere."]}),"\n",(0,n.jsx)(s.h2,{id:"understanding-the-4-sources-of-cost",children:"Understanding the 4 Sources of Cost"}),"\n",(0,n.jsx)(s.p,{children:"The four sources of cost associated with Walrus Storage are acquiring storage resources, uploads,\nSui transactions, and Sui objects on chain:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Storage resources."})," A storage resource is needed to store a ","blob",", with an appropriate capacity\nand epoch duration.\nStorage resources can be acquired from the Walrus system contract while there is free space\navailable on the system against some ","WAL",". Other options are also available, such as receiving it\nfrom other parties, or splitting a larger resource bought occasionally into smaller ones (see\ndiscussion below)."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Upload costs."})," Upon ","blob"," registration, some ","WAL"," is charged to cover the costs of data upload.\nThis ensures that deleting ","blobs"," and reusing the same storage resource for storing a new ","blob"," is\nsustainable for the system."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Sui transactions."})," Storing a ","blob"," involves up to three on-chain actions on Sui.\nOne to acquire a storage resource, another (possibly combined with the first) to\nregister the ","blob"," and associate it with a ",(0,n.jsx)(t,{lookup:"Blob ID",children:"blob ID"}),", and a final one to certify the ","blob","\nas available. These incur some Sui gas costs in SUI to cover the costs of\ncomputation."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"On chain objects."})," Finally, Walrus ","blobs"," are represented as Sui objects\non-chain. Creating these objects sets aside some SUI into the Sui storage fund,\nand most of it is refunded when the objects are deleted after they are not needed\nany more."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["The size of the storage resource needed to store a ","blob",", and the size taken into account to pay\nfor the upload costs, corresponds to the ",(0,n.jsx)(s.em,{children:"encoded size"})," of a\n","blob",". The encoded size of a ","blob"," is the size of the erasure coded ","blob",", which is about 5x larger\nthan the unencoded original ","blob"," size, and the size of some metadata that is independent of the\nsize of the ","blob",". Since the fixed size per-",(0,n.jsx)(t,{lookup:"Blob metadata",children:"blob metadata"})," is quite large (about 64MB in the worse\ncase), the cost of storing small ","blobs"," (< 10MB) is dominated by this, and the size of storing\nlarger ","blobs"," is dominated by their increasing size. See\n",(0,n.jsx)(s.a,{href:"#reducing-costs-for-small-blobs",children:"Reducing costs for small blobs"})," for more information on cost\noptimization strategies."]}),"\n",(0,n.jsx)(s.p,{children:"The Walrus CLI uses some strategies to lower costs but is not guaranteed to be optimal for all\nuse-cases. For high volume or other cost sensitive users there may be strategies that further\nlower costs, which we discuss below."}),"\n",(0,n.jsx)(s.h2,{id:"measuring-costs",children:"Measuring Costs"}),"\n",(0,n.jsxs)(s.p,{children:["The most accurate way to measure the costs of a store for a certain size is to perform a store\nfor a ","blob"," of the same size, and observe the costs in SUI and ","WAL"," in a Sui explorer (or directly\nthrough Sui RPC calls). ","Blob"," contents do not affect costs."]}),"\n",(0,n.jsxs)(s.p,{children:["A ",(0,n.jsx)(s.code,{children:"walrus store <FILENAME> --epochs 1"})," command will result in 2 transactions:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["The first transaction will perform a ",(0,n.jsx)(s.code,{children:"reserve_space"})," (if no storage resource of\nappropriate size exists) and ",(0,n.jsx)(s.code,{children:"register_blob"}),"; and will affect the balances of both\nSUI and ","WAL","."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["The second will perform a single call to ",(0,n.jsx)(s.code,{children:"certify_blob"})," and will only change the SUI balance."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["You can observe the storage rebate on an explorer by burning the resulting ","blob"," objects\nusing the command ",(0,n.jsx)(s.code,{children:"walrus burn-blobs --object-ids <BLOB_OBJECT_ID>"}),". As discussed below,\nburning the object on Sui does not delete the ","blob"," on Walrus."]}),"\n",(0,n.jsxs)(s.p,{children:["As a rule of thumb, the SUI costs of ",(0,n.jsx)(s.code,{children:"register_blob"})," and ",(0,n.jsx)(s.code,{children:"certify_blob"})," are independent of\n","blob"," size or epoch lifetime. The ","WAL"," costs of ",(0,n.jsx)(s.code,{children:"register_blob"})," are linear in the encoded size of\nthe ","blob"," (both erasure coding and metadata). Calls to ",(0,n.jsx)(s.code,{children:"reserve_space"})," have SUI costs that\ngrow in the number of epochs, and ","WAL"," costs linear with both encoded size and the number of epochs."]}),"\n",(0,n.jsx)(s.p,{children:"A few commands output information that can assist in cost estimations, without submitting\ntransactions:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"walrus info"})," command displays the current costs for buying storage resources from the\nsystem contract and also cost of uploads."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"walrus store --dry-run ..."})," command outputs the encoded size that is used in calculations\nof ","WAL"," costs. The ",(0,n.jsx)(s.code,{children:"--dry-run"})," parameter ensures no transactions are submitted on chain."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"managing-and-minimizing-costs",children:"Managing and Minimizing Costs"}),"\n",(0,n.jsx)(s.p,{children:"There are multiple ways of acquiring storage resources, which impact their costs."}),"\n",(0,n.jsxs)(s.p,{children:["The primary means is by sending some ","WAL",' to the Walrus system contract to "buy" a storage resource\nfor some size in bytes and a defined lifetime in epochs.']}),"\n",(0,n.jsxs)(s.p,{children:["Furthermore, before acquiring a storage resource, the CLI ",(0,n.jsx)(t,{lookup:"Client",children:"client"})," will use any ",(0,n.jsx)(t,{lookup:"User",children:"user"}),"-owned storage\nresource of an appropriate length (in epochs and size in bytes). However, the current implementation\ndoes not make any attempts yet to properly split or merge storage resources."]}),"\n",(0,n.jsxs)(s.p,{children:["There are a few ways to minimize costs associated with the need for storage resources. First,\nacquiring resources from the system contract involves at least one Sui\ntransaction interacting with a relatively complex shared object Sui smart contract. Therefore,\nacquiring larger storage resources at once both in length and size minimizes the SUI gas costs.\nStorage resources can then be split and merged to store smaller ","blobs"," or ","blobs"," for shorter time\nperiods. Packing multiple smart contract calls into a single Sui PTB to manage storage resource\nacquisition, splitting and merging can also keep costs down."]}),"\n",(0,n.jsxs)(s.p,{children:["Storage resources can be reclaimed and reused for the remainder of their validity period,\nby deleting non-expired ","blobs"," that were created as ",(0,n.jsx)(s.em,{children:"deletable"}),".\nTherefore, dapps that only need to store data for less time\nthan a multiple of full epochs (two weeks on Mainnet), can potentially reduce costs by actively\ndeleting ","blobs",", and re-using the storage for other ","blobs","."]}),"\n",(0,n.jsx)(s.p,{children:"Storage resources can be transferred and traded, and we foresee other markets and ways to\nacquire them to exist in the future."}),"\n",(0,n.jsxs)(s.p,{children:["Registering ","blobs"," and certifying them costs SUI to cover gas costs, and ","WAL"," to cover upload costs.\nEach ","blob"," needs to go through both of these and therefore not much may be done about these costs.\nHowever, multiple ","blobs"," may be registered or certified in a single Sui PTB both to reduce latency\nand, possibly, costs when storing multiple ","blobs",". The CLI ","client"," uses this approach when uploading\nmultiple ","blobs"," simultaneously. Within the same PTB storage resource management actions can also be\nperformed to acquire storage or split/merge storage resources to further reduce latency and costs."]}),"\n",(0,n.jsxs)(s.p,{children:["Each ","blob"," stored on Walrus also creates a Sui object representing the ","blob",". While these objects are\nnot large and only contains metadata, storage on Sui is comparatively expensive and object costs\ncan add up. Once the ","blob"," validity period expires the ","blob"," object has no use and can be burned.\nThis will reclaim most of the storage costs associated with storage on Sui."]}),"\n",(0,n.jsxs)(s.p,{children:["The ","blob"," objects are used to manage ","blob"," lifecycle, such as extending ","blob"," lifetimes, deleting\nthem to reclaim storage resources, or adding attributes. In case none of these actions are needed\nanymore, the ","blob"," object may be burned through the CLI or a smart contract call, to save on Sui\nstorage costs. This does not delete the ","blob"," on Walrus. Depending on the relative costs of SUI and\n","WAL"," it might be cheaper to burn a long lived ","blob"," object, and subsequently re-registering and\nre-certifying them close to the end of its lifetime to extend it."]}),"\n",(0,n.jsxs)(s.h3,{id:"reducing-costs-for-small-blobs",children:["Reducing Costs for Small ","Blobs"]}),"\n",(0,n.jsxs)(s.p,{children:["Walrus ",(0,n.jsx)(s.a,{href:"/docs/usage/quilt",children:"Quilt"})," is a batch storage tool that reduces storage costs for small\n","blobs",". When multiple ","blobs"," are stored together, the metadata costs are amortized across the batch.\nQuilt can also significantly reduce Sui computation and storage costs, as detailed in the\n",(0,n.jsx)(s.a,{href:"/docs/usage/quilt#lower-cost",children:"Lower Cost"})," section."]}),"\n",(0,n.jsx)(s.h2,{id:"the-future",children:"The Future"}),"\n",(0,n.jsxs)(s.p,{children:["The Walrus team has planned initiatives to reduce costs for all ","blob"," sizes by making metadata\nsmaller, as well as further improving the efficiency of Quilt for small ","blob"," storage."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},5076:(e,s,o)=>{o.d(s,{A:()=>t});const t=o.p+"assets/files/walrus_whitepaper_v2-31701a689e75cc47048440b56789f388.pdf"},8885:(e,s,o)=>{o.d(s,{R:()=>i,x:()=>a});var t=o(9378);const n={},r=t.createContext(n);function i(e){const s=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);